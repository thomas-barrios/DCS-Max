# AutoHotkey Integration Guide

**Powerful automation scripting for DCS-Max performance testing and system optimization**

## ğŸ“‹ **Overview**

AutoHotkey is a free, open-source scripting language for Windows that enables automation of repetitive tasks, keyboard shortcuts, and complex workflows. In DCS-Max, AutoHotkey scripts handle automated performance testing, system configuration changes, and benchmark execution, making large-scale optimization testing feasible and repeatable.

## ğŸ¯ **Why AutoHotkey for DCS Testing**

### **Automation Capabilities**
- âœ… **Macro recording and playback** - Automate complex test sequences
- âœ… **Window manipulation** - Control DCS, CapFrameX, and system dialogs
- âœ… **Keyboard/mouse simulation** - Precise input timing for testing
- âœ… **File system operations** - Manage test data and configurations
- âœ… **Process monitoring** - Detect application states and respond accordingly

### **DCS-Max Integration**
- âœ… **Benchmark automation** - Automated DCS launch, mission loading, and performance capture
- âœ… **Configuration switching** - Automated graphics setting changes between tests
- âœ… **System optimization** - Automated service/registry tweaks with timing controls
- âœ… **Error handling** - Robust scripts that recover from common issues

## ğŸš€ **Installation & Setup**

### **Step 1: Download and Install**
1. **Visit**: [AutoHotkey Official Site](https://www.autohotkey.com/)
2. **Download** the latest version (v2.x recommended for new scripts)
3. **Install** with default settings
4. **Verify installation** by right-clicking desktop â†’ New â†’ AutoHotkey Script

### **Step 2: Basic Configuration**
```
AutoHotkey Installation:
â”œâ”€â”€ Version: 2.x (latest stable)
â”œâ”€â”€ Installation Path: C:\Program Files\AutoHotkey\
â”œâ”€â”€ Add to PATH: Enabled (for command-line execution)
â””â”€â”€ File Associations: .ahk files associated with AutoHotkey
```

### **Step 3: Development Environment**
```
Recommended Setup:
â”œâ”€â”€ Editor: Visual Studio Code with AutoHotkey extension
â”œâ”€â”€ Debugging: AutoHotkey's built-in debugger
â”œâ”€â”€ Testing: Run scripts with #Warn directive for error checking
â””â”€â”€ Documentation: Official AutoHotkey documentation and forums
```

## ğŸ”§ **Integration with DCS Max**

### **Automated Benchmark Workflow**
The `4.1.2-dcs-benchmark-automation.ahk` script automatically:

1. **Validates system state** and required applications
2. **Launches CapFrameX** and DCS in sequence
3. **Loads test mission** with configurable parameters
4. **Executes performance recording** for specified duration
5. **Manages file output** and moves to next test iteration
6. **Handles errors** and provides detailed logging

### **Script Organization**
```
DCS-Max AutoHotkey Scripts:
â”œâ”€â”€ 4.1.2-dcs-benchmark-automation.ahk (Main benchmark runner)
â”œâ”€â”€ Helper functions for window detection and manipulation
â”œâ”€â”€ Configuration variables for timing and paths
â””â”€â”€ Error handling and recovery mechanisms
```

### **Configuration Variables**
In `4.1.2-dcs-benchmark-automation.ahk`:
```autohotkey
; DCS Configuration
dcsPath := "D:\Program Files\Eagle Dynamics\DCS World\bin\DCS.exe"
missionPath := "C:\Projects\DCS-Max\4-Performance-Testing\benchmark-missions\"

; CapFrameX Configuration
capframexPath := "C:\Program Files\CapFrameX\CapFrameX.exe"
capframexFolder := "C:\Users\Thomas\Documents\CapFrameX\Captures"

; Timing Configuration
WaitDCSLoad := 30000      ; 30 seconds for DCS to load
WaitMissionLoad := 45000  ; 45 seconds for mission loading
WaitRecordLength := 120000 ; 120 seconds recording time
WaitCapFrameXWrite := 5000 ; 5 seconds for file write
```

## ğŸ“Š **Understanding AutoHotkey Features for DCS**

### **Key Automation Features**
| Feature | DCS-Max Usage | Benefits |
|---------|---------------|----------|
| **Window Detection** | Find DCS/CapFrameX windows reliably | Robust automation across different setups |
| **Pixel Search** | Detect loading screens, menus | Precise timing for test execution |
| **Hotkey Management** | Send F11 for recording start/stop | Integration with external tools |
| **File Operations** | Move/rename capture files | Automated data organization |
| **Process Control** | Launch/close applications | Clean test environment management |

## ğŸ® **DCS-Specific Automation Scenarios**

### **Benchmark Test Sequence**
```
Automated Workflow:
â”œâ”€â”€ System preparation (disable services, set priorities)
â”œâ”€â”€ Launch CapFrameX and start monitoring
â”œâ”€â”€ Launch DCS with specific mission
â”œâ”€â”€ Wait for mission load completion
â”œâ”€â”€ Execute test flight pattern (if automated)
â”œâ”€â”€ Trigger performance recording
â”œâ”€â”€ Run test for specified duration
â”œâ”€â”€ Stop recording and save data
â”œâ”€â”€ Close applications and restore system state
â””â”€â”€ Move to next test configuration
```

### **Configuration Management**
```
Setting Changes:
â”œâ”€â”€ Registry modifications for graphics settings
â”œâ”€â”€ Service state changes (start/stop)
â”œâ”€â”€ File-based configuration updates
â”œâ”€â”€ System parameter adjustments
â””â”€â”€ Validation of changes before testing
```

## ğŸ“ˆ **Script Development Best Practices**

### **Error Handling**
```autohotkey
; Robust error handling example
Try {
    RunWait dcsPath
} Catch Error as err {
    LogError("Failed to launch DCS: " err.Message)
    Return false
}
```

### **Timing and Synchronization**
```autohotkey
; Wait for DCS window with timeout
WinWait "DCS World", , 60
If WinExist("DCS World") {
    ; Continue with automation
} Else {
    LogError("DCS failed to start within timeout")
}
```

### **Logging and Debugging**
```autohotkey
; Comprehensive logging
Log(message) {
    FileAppend FormatTime() " - " message "`n", "automation.log"
}
```

## ğŸ” **Troubleshooting Common Issues**

### **Script Not Executing**
```
Solutions:
â”œâ”€â”€ Check AutoHotkey version compatibility
â”œâ”€â”€ Run as Administrator for system modifications
â”œâ”€â”€ Verify file paths and permissions
â”œâ”€â”€ Enable #Warn for debugging information
â””â”€â”€ Check Windows security settings for script execution
```

### **Timing Issues**
```
Solutions:
â”œâ”€â”€ Increase wait times for slower systems
â”œâ”€â”€ Use WinWaitActive instead of Sleep
â”œâ”€â”€ Implement retry logic for unreliable operations
â”œâ”€â”€ Monitor system performance during execution
```

### **Window Detection Problems**
```
Solutions:
â”œâ”€â”€ Use ahk_exe for process-based detection
â”œâ”€â”€ Implement fuzzy title matching
â”œâ”€â”€ Add delays before window operations
â”œâ”€â”€ Test on different screen resolutions
```

## ğŸ’¡ **Pro Tips for DCS Automation**

### **Performance Optimization**
- âœ… **Minimize Sleep commands** - Use event-driven waiting when possible
- âœ… **Batch operations** - Group similar actions to reduce overhead
- âœ… **Memory management** - Clean up variables and close handles
- âœ… **CPU efficiency** - Avoid busy-waiting loops

### **Reliability**
- âœ… **Error recovery** - Always include fallback procedures
- âœ… **State validation** - Check conditions before proceeding
- âœ… **Logging** - Detailed logs for troubleshooting
- âœ… **Testing** - Thorough testing on target hardware

### **Maintenance**
- âœ… **Modular design** - Separate functions for reusability
- âœ… **Configuration files** - External config for easy adjustments
- âœ… **Version control** - Track script changes
- âœ… **Documentation** - Comment complex logic

---

**âš¡ Automate your DCS optimization workflow with powerful, reliable scripting!**